import{_ as S,u as F,r as n,i as L,a as l,o as h,c as A,b as t,d as e,w as P,F as q,e as B,f as b,n as I,p as T,g as $}from"./index-b9a928ac.js";import{a as x,C as j}from"./js.cookie-5281431b.js";const _=i=>(T("data-v-e5e58b34"),i=i(),$(),i),M={class:"min-h-screen bg-gray-100 flex flex-col justify-center sm:py-12"},N={class:"mx-auto w-[calc(100%-2rem)] md:w-[600px]"},U=_(()=>e("h1",{class:"font-black text-center text-[32px]/[1.2] mb-5"},"請先登入",-1)),z={class:"bg-white shadow w-full rounded-lg divide-y divide-gray-200"},D=_(()=>e("label",{for:"inputEmail",class:"font-semibold text-sm text-gray-600 pb-1 block"},"電子信箱",-1)),J=_(()=>e("label",{for:"inputPassword",class:"font-semibold text-sm text-gray-600 pb-1 block mt-5"},"密碼",-1)),R={class:"relative"},G=["disabled"],H=_(()=>e("span",{class:"inline-block mr-2"},"登入",-1)),K=[H],O={__name:"AdminLogin",setup(i){const k=F(),a=n({username:"",password:""}),r=n(!1),c=n(!0),y=n("password"),v=()=>{c.value=!c.value,y.value=c.value?"password":"text"},f=L("emitter"),V=n(null),C=async()=>{try{const d=x.get("hexToken");r.value=!0,d||x.remove("hexToken",{path:""});const s="https://vue3-course-api.hexschool.io/admin/signin",o=await B.post(s,a.value);if(o.data.success){r.value=!1;const{token:u,expired:m}=o.data,p=j.AES.encrypt(u,"secret key 123").toString();document.cookie=`hexToken=${p}; expires=${new Date(m)}`,k.push({name:"adminProducts"}),f.emit("push-message",{style:"green-500",title:"登入成功"})}else r.value=!1,V.value=o.data.error.message,f.emit("push-message",{style:"red-500",title:"登入失敗",content:o.data.error.message})}catch(d){throw r.value=!1,f.emit("push-message",{style:"red-500",title:"登入失敗"}),new Error(d)}};return(d,s)=>{const o=l("LoadingComponent"),u=l("VField"),m=l("ErrorMessage"),p=l("font-awesome-icon"),E=l("VForm");return h(),A(q,null,[t(o,{active:r.value},null,8,["active"]),e("div",M,[e("div",N,[U,e("div",z,[t(E,{class:"px-5 py-7",onSubmit:C},{default:P(({meta:w})=>[D,t(u,{type:"email",name:"username",class:"rounded-lg focus:border-primary-700 focus:shadow-primary-700 focus:ring-primary-700-focus px-4 py-3 mt-1 w-full",placeholder:"電子信箱",id:"inputEmail",required:"",autofocus:"",autocomplete:"email",label:"電子信箱",rules:"required|email",modelValue:a.value.username,"onUpdate:modelValue":s[0]||(s[0]=g=>a.value.username=g)},null,8,["modelValue"]),t(m,{name:"username",class:"text-red-700"}),J,e("div",R,[t(u,{type:y.value,name:"password",class:"rounded-lg focus:border-primary-700 focus:shadow-primary-700 focus:ring-primary-700-focus pl-4 pr-10 py-3 mt-1 w-full",id:"inputPassword",placeholder:"密碼",required:"",autocomplete:"current-password",label:"密碼",rules:"required",modelValue:a.value.password,"onUpdate:modelValue":s[1]||(s[1]=g=>a.value.password=g)},null,8,["type","modelValue"]),c.value?(h(),b(p,{key:0,icon:["far","eye"],class:"absolute right-4 p-2.5 mt-2.5 -ml-4",onClick:v})):(h(),b(p,{key:1,icon:["far","eye-slash"],class:"absolute right-4 p-2.5 mt-2.5 -ml-4",onClick:v}))]),t(m,{name:"password",class:"text-red-700"}),e("button",{type:"submit",class:I(["transition duration-200 mt-5 bg-primary-700 hover:bg-primary-700-hover focus:bg-primary-700-focus focus:shadow-sm focus:ring-4 focus:ring-primary-700-focus focus:ring-opacity-50 text-white w-full py-2.5 rounded-lg text-sm shadow-sm hover:shadow-md font-semibold text-center inline-block",{disabled:!w.valid}]),disabled:!w.valid},K,10,G)]),_:1})])])])],64)}}},X=S(O,[["__scopeId","data-v-e5e58b34"]]);export{X as default};
